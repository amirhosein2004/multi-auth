## 🔧 دایرکتوری‌های توسعه که در زمان دیپلوی نباید مستقر شوند

در زمان استقرار پروژه در محیط Production، برخی دایرکتوری‌ها فقط مخصوص توسعه و مستندسازی هستند و نباید در محیط اجرایی (Docker Image یا سرور) مستقر شوند.

### 📁 `schema_docs/`
این دایرکتوری شامل داکیومنت‌های `drf-spectacular` و توضیحات Swagger است که فقط در زمان توسعه (`DEBUG=True`) مورد استفاده قرار می‌گیرند.

- این دایرکتوری از طریق تنظیمات `urls.py` در زمان `DEBUG=False` غیرفعال است.
- همچنین در فایل `.dockerignore` مشخص شده که این دایرکتوری در زمان ساخت Docker Image نهایی کپی نشود.

```dockerignore
schema_docs/

```

# 🚀 استقرار پروژه Learnfolio

این راهنما مراحل کامل استقرار پروژه با استفاده از Docker و Docker Compose را پوشش می‌دهد.

## ✅ پیش‌نیازها

- **Docker**: آخرین نسخه Docker باید نصب باشد. ([لینک دانلود](https://www.docker.com/products/docker-desktop/))
- **Docker Compose**: معمولاً به همراه Docker نصب می‌شود.
- **Git**: برای کلون کردن پروژه.

---

## ⚙️ مراحل راه‌اندازی و اجرا

### ۱. کلون کردن پروژه

ابتدا پروژه را از مخزن Git کلون کنید:
```bash
git clone <your-repository-url>
cd learnfolio
```

### ۲. پیکربندی متغیرهای محیطی

یک فایل `.env` در ریشه پروژه ایجاد کنید. می‌توانید از فایل `.env.example` به عنوان الگو استفاده کنید:

```bash
cp .env.example .env
```

سپس فایل `.env` را باز کرده و مقادیر زیر را با توجه به محیط خود (توسعه یا پروداکشن) تنظیم کنید:

- `SECRET_KEY`: یک کلید مخفی و طولانی برای Django تولید کنید.
- `DEBUG`: در محیط پروداکشن حتماً `False` باشد.
- `ALLOWED_HOSTS`: دامنه‌های مجاز برای دسترسی به پروژه (مثلاً `yourdomain.com,www.yourdomain.com`).
- `POSTGRES_PASSWORD`: یک رمز عبور قوی برای دیتابیس PostgreSQL.
- `RABBITMQ_DEFAULT_USER` و `RABBITMQ_DEFAULT_PASS`: نام کاربری و رمز عبور برای RabbitMQ.
- سایر متغیرها مانند کلید API سرویس ایمیل یا پیامک.

### ۳. ساخت و اجرای کانتینرها

با استفاده از Docker Compose، تمام سرویس‌های تعریف شده در فایل `docker-compose.yml` را بسازید و اجرا کنید:

```bash
# این دستور ایمیج‌ها را ساخته و کانتینرها را در پس‌زمینه اجرا می‌کند
docker-compose up --build -d
```

- **`--build`**: ایمیج‌ها را قبل از اجرا مجدداً می‌سازد (برای اولین اجرا یا پس از تغییرات در `Dockerfile`).
- **`-d`**: کانتینرها را در حالت Detached (پس‌زمینه) اجرا می‌کند.

### ۴. اجرای دستورات اولیه Django

پس از اجرای کانتینرها، دستورات مربوط به مایگریشن‌های دیتابیس و جمع‌آوری فایل‌های استاتیک را اجرا کنید:

```bash
# اجرای مایگریشن‌ها
docker-compose exec web python manage.py migrate

# جمع‌آوری فایل‌های استاتیک (برای محیط پروداکشن)
docker-compose exec web python manage.py collectstatic --no-input

# ایجاد کاربر ادمین (اختیاری)
docker-compose exec web python manage.py createsuperuser
```

اکنون پروژه شما باید روی پورت `8000` (یا پورت تنظیم شده در `docker-compose.yml`) در دسترس باشد.

---

## 🐳 سرویس‌های Docker Compose

| سرویس         | پورت‌ها        | توضیح                                                              |
|---------------|----------------|--------------------------------------------------------------------|
| `web`         | `8000:8000`    | کانتینر اصلی که اپلیکیشن Django را با Gunicorn اجرا می‌کند.          |
| `db`          | `5432:5432`    | سرویس پایگاه داده PostgreSQL.                                      |
| `rabbitmq`    | `5672`, `15672`| Message Broker برای Celery. پنل مدیریت آن روی پورت `15672` در دسترس است. |
| `celery`      | -              | Worker-های Celery که وظایف را از صف RabbitMQ دریافت و پردازش می‌کنند. |
| `celery_beat` | -              | زمان‌بند Celery برای اجرای وظایف دوره‌ای.                           |
| `redis`       | `6379:6379`    | سرویس Redis برای کش و ذخیره‌سازی نتایج Celery.                      |

---

## 📝 نکات مهم در محیط Production

- **`DEBUG = False`**: حتماً حالت دیباگ را غیرفعال کنید.
- **`ALLOWED_HOSTS`**: دامنه‌های معتبر را مشخص کنید.
- **SSL/TLS**: برای امنیت ارتباطات، از یک Reverse Proxy مانند Nginx یا Traefik برای مدیریت HTTPS استفاده کنید.
- **مدیریت لاگ‌ها**: لاگ‌های تولید شده توسط کانتینرها را به یک سیستم مدیریت لاگ متمرکز (مانند ELK Stack یا Graylog) ارسال کنید.
- **پشتیبان‌گیری (Backup)**: به صورت منظم از دیتابیس PostgreSQL پشتیبان تهیه کنید.
- **مانیتورینگ**: وضعیت سرویس‌ها (CPU, Memory) را با ابزارهایی مانند Prometheus و Grafana مانیتور کنید.