# ๐ Endpoint: `POST /api/v1/accounts/auth/submit-identity/`

### ๐ฏ ฺฉุงุฑุจุฑุฏ:

ุงู API ุจุฑุง ุซุจุช ุดูุงุณู ฺฉุงุฑุจุฑ (ุงูู ุง ุดูุงุฑู ููุจุงู ุงุฑุงู) ุงุณุชูุงุฏู ูโุดูุฏ. ุฏุฑ ุตูุฑุช ุงุนุชุจุงุฑุณูุฌ ููููุ ฺฉ ฺฉุฏ ุชุฃุฏ (OTP) ุง ููฺฉ ุชุฃุฏ ุจุฑุง ุงุฏุงูู ูุฑุงูุฏ ุซุจุชโูุงู ุง ุจุงุฒุงุจ ุญุณุงุจ ุงุฑุณุงู ุฎูุงูุฏ ุดุฏ.

> ุงู ูุฑุญููุ **ุงููู ฺฏุงู** ุฏุฑ ูุฑุขูุฏ ุงุญุฑุงุฒ ููุช (ุซุจุชโูุงูุ ูุฑูุฏ ุง ุจุงุฒุงุจ ุฑูุฒ ุนุจูุฑ) ุงุณุช.

---

## ๐ ุดุฑุงุท ุงุณุชูุงุฏู

* โ ููุท ฺฉุงุฑุจุฑุงู **(unauthenticated)** ูุฌุงุฒ ุจู ุงุณุชูุงุฏู ูุณุชูุฏ.
* โ ุงุฑุณุงู **ุชูฺฉู ฺฉูพฺุง Turnstile** ุงูุฒุงู ุงุณุช.
* โฑ ูพุณ ุงุฒ ุงุฑุณุงู ููููุ ุชุง **ณ ุฏููู** ุจุฑุง ููุงู ุดูุงุณู ุงูฺฉุงู ุงุฑุณุงู ูุฌุฏุฏ ูุฌูุฏ ูุฏุงุฑุฏ.
* ๐ฆ ุงู endpoint ุชุญุช **ูุญุฏูุฏุช ูุฑุฎ (Rate Limiting)** ุงุณุช:

  * ุฏุฑ ุตูุฑุช ุนุจูุฑ ุงุฒ ุญุฏ ูุฌุงุฒุ ูพุงุณุฎ `429` ููุฑุงู ุจุง ุฒูุงู ุจุงูโูุงูุฏู ุงุฑุณุงู ูโุดูุฏ.

---

## ๐ ุณุทุญ ุฏุณุชุฑุณ

| ุดุฑุท                          | ูุถุนุช                        |
| ---------------------------- | ---------------------------- |
| ูุงุฒ ุจู ูุงฺฏูุ               | โ ุฎุฑ (ูุฎุตูุต ูููุงูโูุง)       |
| ฺฉูพฺุง ุงุฌุจุงุฑุ                 | โ ุจูู (Cloudflare Turnstile) |
| ูุญุฏูุฏุช ูุฑุฎ (Throttle) ูุนุงูุ | โ ุจูู                        |

---

## ๐จ ุฏุฑุฎูุงุณุช

### โค Method: `POST`

### โค URL: `/api/v1/accounts/auth/submit-identity/`

---

### Headers

| ฺฉูุฏ         | ููุฏุงุฑ              |
| ------------ | ------------------ |
| Content-Type | `application/json` |

---

### Body (JSON)

```json
{
  "identity": "example@example.com",
  "cf-turnstile-response": "CAPTCHA_TOKEN"
}
```

| ููุฏ                    | ููุน    | ุงูุฒุงูุ | ุชูุถุญ                                        |
| ----------------------- | ------ | ------- | -------------------------------------------- |
| `identity`              | string | โ       | ุงูู ุง ุดูุงุฑู ููุจุงู ุงุฑุงู (`09xxxxxxxxx`) |
| `cf-turnstile-response` | string | โ       | ุชูฺฉู ูุนุชุจุฑ ฺฉูพฺุง Turnstile                   |

---

## ๐งช ูููููโูุง ูุนุชุจุฑ

#### โ ุงุฑุณุงู ููุจุงู:

```json
{ 
  "identity": "09123456789", 
  "cf-turnstile-response": "TOKEN" 
}
```

#### โ ุงุฑุณุงู ุงูู:

```json
{ 
  "identity": "user@example.com", 
  "cf-turnstile-response": "TOKEN" 
}
```

---

## โ ูพุงุณุฎ ูููู

### โ๏ธ Status Code: `200 OK`

```json
{
  "detail": "ฺฉุฏ ุชุงุฏ ุจู ุดูุงุฑู ููุจุงู ุดูุง ุงุฑุณุงู ุดุฏ.",
  "next_url": "/api/v1/accounts/auth/verify-otp/",
  "purpose": "register"
}
```

| ููุฏ       | ุชูุถุญ                                                  |
| ---------- | ------------------------------------------------------ |
| `detail`   | ูพุงู ููููุชโุขูุฒ ุงุฑุณุงู OTP ุง ููฺฉ                     |
| `next_url` | ูุณุฑ ูุฑุญูู ุจุนุฏ ฺฉู ฺฉูุงูุช ุจุงุฏ ฺฉุงุฑุจุฑ ุฑุง ุจู ุขู ูุฏุงุช ฺฉูุฏ |
| `purpose`  | ูุฏู ุนููุงุช (`register`ุ `login`ุ `reset_password`)     |

---

## โ ูพุงุณุฎโูุง ุฎุทุง

| ฺฉุฏ ูุถุนุช | ุชูุถุญ                                | ููููู ูพุงุณุฎ                                                                                                      |
| -------- | ------------------------------------ | --------------------------------------------------------------------------------------------------------------- |
| `400`    | ูุฑูุฏ ูุงูุนุชุจุฑ ุง ฺฉูพฺุง ูุงูููู         | ๐ ูููููโูุง ุฏุฑ ุงุฏุงูู                                                                                            |
| `403`    | ฺฉุงุฑุจุฑ ูุงุฑุฏ ุดุฏู ู ุงุฌุงุฒู ุงุณุชูุงุฏู ูุฏุงุฑุฏ | `{ "detail": "ุดูุง ูุจูุงู ูุงุฑุฏ ุดุฏูโุงุฏ." }`                                                                       |
| `429`    | ุนุจูุฑ ุงุฒ ุญุฏ ูุฌุงุฒ ุชุนุฏุงุฏ ุฏุฑุฎูุงุณุช        | `{ "detail": "ุดูุง ุจุด ุงุฒ ุญุฏ ูุฌุงุฒ ุฏุฑุฎูุงุณุช ุงุฑุณุงู ฺฉุฑุฏูโุงุฏ.", "available_in_seconds": 42, "limit": 5, "used": 5 }` |
| `500`    | ุฎุทุง ุฏุงุฎู ุณุฑูุฑ ุง ูุดฺฉู ุบุฑููุชุธุฑู    | `{ "detail": "ุฎุทุง ูุงุดูุงุฎุชูโุง ุฑุฎ ุฏุงุฏู ุงุณุช. ูุทูุงู ุฏูุจุงุฑู ุชูุงุด ฺฉูุฏ." }`                                         |

---

### ๐ ููููู ูพุงุณุฎ 400

#### โ ูุฑูุฏ ูุงูุนุชุจุฑ:

```json
{
  "identity": ["ูุฑูุฏ ูุงูุนุชุจุฑ ุงุณุช. ูุทูุงู ฺฉ ุงูู ุง ุดูุงุฑู ุชููู ูุนุชุจุฑ ูุงุฑุฏ ฺฉูุฏ."]
}
```

#### โ ฺฉูพฺุง ูุงูููู:

```json
{
  "detail": "ุงุนุชุจุงุฑุณูุฌ ฺฉูพฺุง ูุงูููู ุจูุฏ."
}
```

---

### ๐ฆ ููููู ูพุงุณุฎ 429 (Throttle ูุนุงู)

```json
{
  "detail": "ุดูุง ุจุด ุงุฒ ุญุฏ ูุฌุงุฒ ุฏุฑุฎูุงุณุช ุงุฑุณุงู ฺฉุฑุฏูโุงุฏ.",
  "available_in_seconds": 42
}
```

| ููุฏ                   | ุชูุถุญ                                     |
| ---------------------- | ----------------------------------------- |
| `detail`               | ูพุงู ุฎุทุง                                  |
| `available_in_seconds` | ุฒูุงู ุจุงูโูุงูุฏู (ุจู ุซุงูู) ุจุฑุง ุชูุงุด ูุฌุฏุฏ |

---